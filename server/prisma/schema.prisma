generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}


model Room {
  id          String   @id @default(uuid())
  name        String
  description String?
  color       String?
  ownerId     String   @map("owner_id")

  items       Item[]

  createdAt   DateTime @map("created_at")
  updatedAt   DateTime @map("updated_at")

  @@index([ownerId])
  @@map("rooms")
}

model Item {
  id           String   @id @default(uuid())
  roomId       String   @map("room_id")
  name         String
  price        Float?
  purchaseDate DateTime?
  description  String?

  files        File[]

  room         Room     @relation(fields: [roomId], references: [id])

  createdAt    DateTime
  updatedAt    DateTime

  @@map("items")
}



model File {
  id        String   @id @default(uuid())
  itemId    String   @map("item_id")
  type      FileType
  url       String
  fileName  String?
  mimeType  String?
  createdAt DateTime @map("created_at")
  
  item      Item     @relation(fields: [itemId], references: [id])

  @@index([itemId])
  @@map("files")
}


enum FileType {
  INVOICE
  IMAGE
}


// Ã  mettre sur supabase 

// create type file_type as enum (
//   'INVOICE',
//   'IMAGE'
// );


// create table files (
//   id uuid primary key default gen_random_uuid(),
//   item_id uuid not null,
//   type file_type not null,
//   url text not null,

//   file_name text,
//   mime_type text,

//   created_at timestamptz default now(),


//   constraint fk_files_item
//     foreign key (item_id)
//     references items(id)
//     on delete cascade
// );


// create index idx_files_item_id on files(item_id);
// create index idx_files_type on files(type);
